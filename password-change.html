<html>

<head>
  <link rel="stylesheet" type="text/css"
    href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  <style>
    html {
      background: #2d2d2d;
      color: white;
    }

    .page-container {
      background: #2d2d2d;
      color: white;
      height: 100%;
    }

    #form-input {
      margin-top: 6%;
      height: 80%;
    }

    .input-field {
      text-align: center;
      width: 60%;
    }
  </style>
</head>
<div class="page-container">
  <form id="form-input" class="d-flex flex-column justify-content-around align-items-center">
    <h1 class="row">
      Change Password
    </h1>
    <input class="input-field form-control" name='oldpassword' type='password' placeholder="Old Password" value="">
    <input class="input-field form-control" name='newpassword' type='password' placeholder="New Password" value="">
    <input class="input-field form-control" name='newpasswordconfirm' type='password' placeholder="Confirm New Password"
      value="">
    <input class="input-field btn btn-success" type="button" id="submit-button"
      onclick='showWorking();google.script.run.withSuccessHandler(onSuccess).changePassword(document.getElementById("form-input"));'
      name="Submit" value="Submit">
  </form>
</div>
<script>
  function onSuccess(obj) {
    document.getElementById('submit-button').style.display = "block";
    if (obj.status == 'done') {
      google.script.host.closeDialog();
    }
    else {
      alert("Incorrect Old Password. Please retry");
    }
  }
  function showWorking() {
    document.getElementById('submit-button').style.display = "none";
  }
</script>

</html>